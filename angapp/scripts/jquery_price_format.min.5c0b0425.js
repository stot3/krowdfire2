!function(e){e.fn.priceFormat=function(t){t=e.extend({prefix:"US$ ",suffix:"",centsSeparator:".",thousandsSeparator:",",limit:!1,centsLimit:2,clearPrefix:!1,clearSufix:!1,allowNegative:!1,insertPlusSign:!1,clearOnEmpty:!1},t);return this.each((function(){function m(e){n.is("input")?n.val(e):n.html(e)}function g(){return r=n.is("input")?n.val():n.html()}function y(e){for(var t="",n=0;n<e.length;n++)char_=e.charAt(n),0==t.length&&0==char_&&(char_=!1),char_&&char_.match(i)&&(f?t.length<f&&(t+=char_):t+=char_);return t}function w(t,n){if(!n&&(""===t||t==w("0",!0))&&v)return"";var r=function(e){for(;e.length<l+1;)e="0"+e;return e}(y(t)),i="",f=0;0==l&&(u="",c="");var c=r.substr(r.length-l,l),h=r.substr(0,r.length-l);if(r=0==l?h:h+u+c,a||""!=e.trim(a)){for(var m=h.length;m>0;m--)char_=h.substr(m-1,1),++f%3==0&&(char_=a+char_),i=char_+i;i.substr(0,1)==a&&(i=i.substring(1,i.length)),r=0==l?i:i+u+c}return!p||0==h&&0==c||(r=-1!=t.indexOf("-")&&t.indexOf("+")<t.indexOf("-")?"-"+r:d?"+"+r:""+r),s&&(r=s+r),o&&(r+=o),r}function S(){var e=g(),t=w(e);e!=t&&m(t),0==parseFloat(e)&&v&&m("")}function N(){""!=e.trim(s)&&c&&m(g().split(s)[1])}function C(){""!=e.trim(o)&&h&&m(g().split(o)[0])}var n=e(this),r="",i=/[0-9]/;r=n.is("input")?n.val():n.html();var s=t.prefix,o=t.suffix,u=t.centsSeparator,a=t.thousandsSeparator,f=t.limit,l=t.centsLimit,c=t.clearPrefix,h=t.clearSuffix,p=t.allowNegative,d=t.insertPlusSign,v=t.clearOnEmpty;d&&(p=!0),n.bind("keydown.price_format",(function(e){var t=e.keyCode?e.keyCode:e.which,n=String.fromCharCode(t),i=!1,s=r,o=w(s+n);(t>=48&&t<=57||t>=96&&t<=105)&&(i=!0),8==t&&(i=!0),9==t&&(i=!0),13==t&&(i=!0),46==t&&(i=!0),37==t&&(i=!0),39==t&&(i=!0),!p||189!=t&&109!=t&&173!=t||(i=!0),!d||187!=t&&107!=t&&61!=t||(i=!0),i||(e.preventDefault(),e.stopPropagation(),s!=o&&m(o))})),n.bind("keyup.price_format",S),n.bind("focusout.price_format",S),c&&(n.bind("focusout.price_format",(function(){N()})),n.bind("focusin.price_format",(function(){n.val(s+g())}))),h&&(n.bind("focusout.price_format",(function(){C()})),n.bind("focusin.price_format",(function(){n.val(g()+o)}))),g().length>0&&(S(),N(),C())}))},e.fn.unpriceFormat=function(){return e(this).unbind(".price_format")},e.fn.unmask=function(){var t,n="";for(var r in t=e(this).is("input")?e(this).val():e(this).html())isNaN(t[r])&&"-"!=t[r]||(n+=t[r]);return n}}(jQuery);