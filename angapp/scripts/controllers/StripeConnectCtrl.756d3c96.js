app.controller("StripeConnectCtrl",["$location","$scope","StripeService",function($location,$scope,StripeService){"access_denied"==$location.search().error?$location.url(atob($location.search().state)):StripeService.connect().then((function(success){StripeService.getAccount().then((function(accounts){if(angular.forEach(accounts,(function(account){account.id==success.id||account.access_token!=success.access_token&&account.publishable_key!=success.publishable_key||StripeService.removeStripeConnect(success)})),$location.search().state){var redirect=$location.search().state,decode=atob(redirect);$location.url(decode)}})),$scope.$emit("loading_finished")}),(function(failed){if($location.search().state){var redirect=$location.search().state,decode=atob(redirect);$location.url(decode)}$scope.$emit("loading_finished")}))}]);