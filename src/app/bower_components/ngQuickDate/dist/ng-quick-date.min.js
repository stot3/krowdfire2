(function(){var e;(e=angular.module("ngQuickDate",[])).provider("ngQuickDateDefaults",function(){return{options:{dateFormat:"M/d/yyyy",timeFormat:"h:mm a",labelFormat:null,placeholder:"Click to Set Date",hoverText:null,buttonIconHtml:null,closeButtonHtml:"&times;",nextLinkHtml:"Next &rarr;",prevLinkHtml:"&larr; Prev",disableTimepicker:!1,disableClearButton:!1,defaultTime:null,dayAbbreviations:["Su","M","Tu","W","Th","F","Sa"],dateFilter:null,parseDateFunction:function(e){var t;return t=Date.parse(e),isNaN(t)?null:new Date(t)}},$get:function(){return this.options},set:function(e,t){var n,a,i;if("object"==typeof e){for(n in i=[],e)a=e[n],i.push(this.options[n]=a);return i}return this.options[e]=t}}}),e.directive("quickDatepicker",["ngQuickDateDefaults","$filter","$sce",function(e,t,n){return{restrict:"E",require:"?ngModel",scope:{dateFilter:"=?",onChange:"&",required:"@"},replace:!0,link:function(a,i,r,l){var u,d,o,c,s,p,m,g,h,f,D,v,k;return p=function(){var e;return f(),a.toggleCalendar(!1),a.weeks=[],a.inputDate=null,a.inputTime=null,a.invalid=!0,"string"==typeof r.initValue&&l.$setViewValue(r.initValue),a.defaultTime||(e=new Date(2013,0,1,12,0),a.datePlaceholder=t("date")(e,a.dateFormat),a.timePlaceholder=t("date")(e,a.timeFormat)),h(),g()},f=function(){var t;for(t in e)e[t],t.match(/[Hh]tml/)?a[t]=n.trustAsHtml(e[t]||""):!a[t]&&r[t]?a[t]=r[t]:a[t]||(a[t]=e[t]);if(a.disableTimepicker="true"==a.disableTimepicker,a.labelFormat||(a.labelFormat=a.dateFormat,a.disableTimepicker||(a.labelFormat+=" "+a.timeFormat)),r.iconClass&&r.iconClass.length)return a.buttonIconHtml=n.trustAsHtml("<i ng-show='iconClass' class='"+r.iconClass+"'></i>")},u=!1,window.document.addEventListener("click",function(e){return a.calendarShown&&!u&&(a.toggleCalendar(!1),a.$apply()),u=!1}),angular.element(i[0])[0].addEventListener("click",function(e){return u=!0}),g=function(){var e;return e=l.$modelValue?m(l.$modelValue):null,v(),D(e),a.mainButtonStr=e?t("date")(e,a.labelFormat):a.placeholder,a.invalid=l.$invalid},D=function(e){return null!=e?(a.inputDate=t("date")(e,a.dateFormat),a.inputTime=t("date")(e,a.timeFormat)):(a.inputDate=null,a.inputTime=null)},h=function(e){var t;return null==e&&(e=null),"Invalid Date"===(t=null!=e?new Date(e):new Date).toString()&&(t=new Date),t.setDate(1),a.calendarDate=new Date(t)},v=function(){var e,t,n,i,r,u,o,c,p,m,g,h,f;for(r=a.calendarDate.getDay(),n=s(a.calendarDate.getFullYear(),a.calendarDate.getMonth()),i=Math.ceil((r+n)/7),m=[],(e=new Date(a.calendarDate)).setDate(e.getDate()+-1*r),u=g=0,f=i-1;0<=f?g<=f:g>=f;u=0<=f?++g:--g)for(m.push([]),h=0;h<=6;++h)t=new Date(e),a.defaultTime&&(c=a.defaultTime.split(":"),t.setHours(c[0]||0),t.setMinutes(c[1]||0),t.setSeconds(c[2]||0)),o=l.$modelValue&&t&&d(t,l.$modelValue),p=d(t,new Date),m[u].push({date:t,selected:o,disabled:"function"==typeof a.dateFilter&&!a.dateFilter(t),other:t.getMonth()!==a.calendarDate.getMonth(),today:p}),e.setDate(e.getDate()+1);return a.weeks=m},l.$parsers.push(function(e){return a.required&&null==e?(l.$setValidity("required",!1),null):angular.isDate(e)?(l.$setValidity("required",!0),e):angular.isString(e)?(l.$setValidity("required",!0),a.parseDateFunction(e)):null}),l.$formatters.push(function(e){return angular.isDate(e)?e:angular.isString(e)?a.parseDateFunction(e):void 0}),function(e,n){return t("date")(e,n)},k=function(e){return"string"==typeof e?m(e):e},m=e.parseDateFunction,d=function(e,t,n){return null==n&&(n=!1),n?e-t==0:(e=k(e),t=k(t),e&&t&&e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())},o=function(e,t){return!(!e||!t)&&parseInt(e.getTime()/6e4)===parseInt(t.getTime()/6e4)},s=function(e,t){return[31,e%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]},c=function(e,t){var n,a,i,r,l,u;return l=n=a=u=r=null,i=function(){var e;return e=+new Date-u,l=e<t&&e>0?setTimeout(i,t-e):null},function(){return a=this,n=arguments,u=+new Date,l||(l=setTimeout(i,t),r=e.apply(a,n),a=n=null),r}},l.$render=function(){return h(l.$viewValue),g()},l.$viewChangeListeners.unshift(function(){if(h(l.$viewValue),g(),a.onChange)return a.onChange()}),a.$watch("calendarShown",function(e,t){if(e)return angular.element(i[0].querySelector(".quickdate-date-input"))[0].select()}),a.toggleCalendar=c(function(e){return isFinite(e)?a.calendarShown=e:a.calendarShown=!a.calendarShown},150),a.selectDate=function(e,t){return null==t&&(t=!0),!l.$viewValue&&e||l.$viewValue&&!e||e&&l.$viewValue&&e.getTime()!==l.$viewValue.getTime(),!("function"==typeof a.dateFilter&&!a.dateFilter(e))&&(l.$setViewValue(e),t&&a.toggleCalendar(!1),!0)},a.selectDateFromInput=function(e){var t,n,i,r;null==e&&(e=!1);try{if(!(n=m(a.inputDate)))throw"Invalid Date";if(!a.disableTimepicker&&a.inputTime&&a.inputTime.length&&n){if(r=a.disableTimepicker?"00:00:00":a.inputTime,!(i=m(a.inputDate+" "+r)))throw"Invalid Time";n=i}if(!o(l.$viewValue,n)&&!a.selectDate(n,!1))throw"Invalid Date";return e&&a.toggleCalendar(!1),a.inputDateErr=!1,a.inputTimeErr=!1}catch(e){if("Invalid Date"===(t=e))return a.inputDateErr=!0;if("Invalid Time"===t)return a.inputTimeErr=!0}},a.onDateInputTab=function(){return a.disableTimepicker&&a.toggleCalendar(!1),!0},a.onTimeInputTab=function(){return a.toggleCalendar(!1),!0},a.nextMonth=function(){return h(new Date(new Date(a.calendarDate).setMonth(a.calendarDate.getMonth()+1))),g()},a.prevMonth=function(){return h(new Date(new Date(a.calendarDate).setMonth(a.calendarDate.getMonth()-1))),g()},a.clear=function(){return a.selectDate(null,!0)},p()},template:"<div class='quickdate'>\n  <a href='' ng-click='toggleCalendar()' class='quickdate-button' title='{{hoverText}}'><div ng-hide='iconClass' ng-bind-html='buttonIconHtml'></div>{{mainButtonStr}}</a>\n  <div class='quickdate-popup' ng-class='{open: calendarShown}'>\n    <a href='' tabindex='-1' class='quickdate-close' ng-click='toggleCalendar()'><div ng-bind-html='closeButtonHtml'></div></a>\n    <div class='quickdate-text-inputs'>\n      <div class='quickdate-input-wrapper'>\n        <label>Date</label>\n        <input class='quickdate-date-input' ng-class=\"{'ng-invalid': inputDateErr}\" name='inputDate' type='text' ng-model='inputDate' placeholder='{{ datePlaceholder }}' ng-enter=\"selectDateFromInput(true)\" ng-blur=\"selectDateFromInput(false)\" on-tab='onDateInputTab()' />\n      </div>\n      <div class='quickdate-input-wrapper' ng-hide='disableTimepicker'>\n        <label>Time</label>\n        <input class='quickdate-time-input' ng-class=\"{'ng-invalid': inputTimeErr}\" name='inputTime' type='text' ng-model='inputTime' placeholder='{{ timePlaceholder }}' ng-enter=\"selectDateFromInput(true)\" ng-blur=\"selectDateFromInput(false)\" on-tab='onTimeInputTab()'>\n      </div>\n    </div>\n    <div class='quickdate-calendar-header'>\n      <a href='' class='quickdate-prev-month quickdate-action-link' tabindex='-1' ng-click='prevMonth()'><div ng-bind-html='prevLinkHtml'></div></a>\n      <span class='quickdate-month'>{{calendarDate | date:'MMMM yyyy'}}</span>\n      <a href='' class='quickdate-next-month quickdate-action-link' ng-click='nextMonth()' tabindex='-1' ><div ng-bind-html='nextLinkHtml'></div></a>\n    </div>\n    <table class='quickdate-calendar'>\n      <thead>\n        <tr>\n          <th ng-repeat='day in dayAbbreviations'>{{day}}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat='week in weeks'>\n          <td ng-mousedown='selectDate(day.date, true, true)' ng-click='$event.preventDefault()' ng-class='{\"other-month\": day.other, \"disabled-date\": day.disabled, \"selected\": day.selected, \"is-today\": day.today}' ng-repeat='day in week'>{{day.date | date:'d'}}</td>\n        </tr>\n      </tbody>\n    </table>\n    <div class='quickdate-popup-footer'>\n      <a href='' class='quickdate-clear' tabindex='-1' ng-hide='disableClearButton' ng-click='clear()'>Clear</a>\n    </div>\n  </div>\n</div>"}}]),e.directive("ngEnter",function(){return function(e,t,n){return t.bind("keydown keypress",function(t){if(13===t.which)return e.$apply(n.ngEnter),t.preventDefault()})}}),e.directive("onTab",function(){return{restrict:"A",link:function(e,t,n){return t.bind("keydown keypress",function(t){if(9===t.which&&!t.shiftKey)return e.$apply(n.onTab)})}}})}).call(this);